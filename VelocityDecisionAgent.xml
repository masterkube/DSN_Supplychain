<?xml version="1.0" encoding="UTF-8"?>
<Agent>
	<AgentName>VelocityDecisionAgent</AgentName>
    <Compose>
        <ArithmeticAgentCommand><AgentExpression>Velocity=InventoryAccumulator/LifeofNode</AgentExpression></ArithmeticAgentCommand>
        <ArithmeticAgentCommand><AgentExpression>StockRequired=Velocity*LeadTime</AgentExpression></ArithmeticAgentCommand>
        <Tell><action><actionName>InventoryAccumulator</actionName></action><internal>true</internal></Tell>
        <Tell><action><actionName>LifeofNode</actionName></action><internal>true</internal></Tell>
        <Tell><action><actionName>LeadTime</actionName></action><internal>true</internal></Tell>
        <Decision>
            <Expression>InvQuantity&gt;StockRequired</Expression>
            <TrueEvent>
                <Tell><action><actionName>SglOverStock</actionName></action><internal>true</internal></Tell>
            </TrueEvent>
            <FalseEvent>
                <Tell><action><actionName>SglUnderStock</actionName></action><internal>true</internal></Tell>
            </FalseEvent>
        </Decision>
        <Choice>
            <ChoiceOption>
                <Ask><action><actionName>SglOverStock</actionName></action><internal>true</internal></Ask>
                <OptionAction>
                    <Choice>
                        <ChoiceOption>
                            <Ask><action><actionName>RunDecision</actionName></action><internal>true</internal></Ask>
                            <OptionAction>
                                <Compose>
                                    <Tell><action><actionName>InvQuantity</actionName></action><internal>true</internal></Tell>
                                    <Tell><action><actionName>StockRequired</actionName></action><internal>true</internal></Tell>
                                    <AgentCommand><AgentName>VelocityDecisionAgent1</AgentName></AgentCommand> 
                                </Compose>                       
                            </OptionAction>
                        </ChoiceOption>
                        <ChoiceOption>
                            <Tell><action><actionName>OverStock</actionName></action></Tell>
                            <OptionAction>
                            </OptionAction>
                        </ChoiceOption>
                    </Choice>
                </OptionAction>
            </ChoiceOption>
            <ChoiceOption>
                <Ask><action><actionName>SglUnderStock</actionName></action><internal>true</internal></Ask>
                <OptionAction>
                    <Choice>
                        <ChoiceOption>
                            <Ask><action><actionName>RunDecision</actionName></action><internal>true</internal></Ask>
                            <OptionAction>
                                <Compose>
                                    <Tell><action><actionName>InvQuantity</actionName></action><internal>true</internal></Tell>
                                    <Tell><action><actionName>StockRequired</actionName></action><internal>true</internal></Tell>
                                    <AgentCommand><AgentName>VelocityDecisionAgent1</AgentName></AgentCommand>
                                </Compose>                       
                            </OptionAction>
                        </ChoiceOption>
                        <ChoiceOption>
                            <Tell><action><actionName>UnderStock</actionName></action></Tell>
                            <OptionAction>
                            </OptionAction>
                        </ChoiceOption>
                    </Choice>
                </OptionAction>
            </ChoiceOption>
        </Choice>
    </Compose>
</Agent>